# kanal_test
Тестовое задание канал сервис

## Демонстрационная версия
[Посмотреть на сервере](http://89.22.227.82:8008/) без регистрации и смс

## Описание

- [Ссылка на таблицу](https://docs.google.com/spreadsheets/d/1i2AmFE2ud_k-nOCDilIsStHpvJgQVJ3PMf-Jo4UCKZ4)
- Для реализации задачи выбран *Django*, хранение данных в *PostgreSQL*
- Обновление данных реализовано через *Celery*, брокер *Redis*, планировщик *Celery beat*
- Все параметры вынесены в `.env` файл
- Для модели написаны тесты
- Не рекомендуется ставить обновление или отправку слишком частыми (чаще 10 секунд), т.к это приводит к временной блокировке от Google
- Для получения сообщений в телеграмм необходимо создать своего бота или пригласить в группу [kanal_test_bot](https://t.me/kanal11_test_bot)
- Если опущены какие-то детали готов уточнить и обсудить в [телеграмме](https://t.me/fenn_r)

## Запуск

### Docker

- Клонировать репозиторий
- Создать файл .env на основе .env_example (могу через telegram переслать токен для бота, если выложить он заблокируется)
- Выполнить сборку `docker-compose up`
- Посмотреть результат на [8008 порте](http://localhost:8008/)

### Без Docker'а

- Клонировать репозиторий
- Установить [poetry](https://www.jetbrains.com/help/pycharm/poetry.html)
- Установить зависимости `poetry install`
- Установить *Postgres*
- Скачать и запустить в отдельном терминале *redis* [(для Windows)](https://github.com/microsoftarchive/redis/releases/tag/win-3.2.100)
- В отдельном терминале запустить *celery* `celery -A kanal_test worker -l info --pool=solo`
- В отдельном терминале запустить *celery beat* `celery -A kanal_test beat`
- Обновить БД `python manage.py migrate`
- Запустить `python manage.py runserver 127.0.0.1:8000`

Если выполнены все действия, но что-то не работает стоит проверить логи и убедиться, что в .env все передано правильно.

Ну или запустить Докер.